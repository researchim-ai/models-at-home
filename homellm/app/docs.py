import streamlit as st
import math

def render_docs():
    """–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é."""
    
    st.header("üìö –£—á–µ–±–Ω–∏–∫ –∏ –°–ø—Ä–∞–≤–∫–∞")
    st.markdown("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ **Models at Home**! –ó–¥–µ—Å—å –≤—ã –Ω–∞—É—á–∏—Ç–µ—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ —Å –Ω—É–ª—è.")

    # –°–æ–∑–¥–∞–µ–º —Ç–∞–±—ã –≤–Ω—É—Ç—Ä–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è —É–¥–æ–±–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    doc_tab1, doc_tab2, doc_tab3, doc_tab4, doc_tab5 = st.tabs([
        "üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è", 
        "üìà Scaling Laws",
        "üß† –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?", 
        "üìñ –°–ª–æ–≤–∞—Ä—å —Ç–µ—Ä–º–∏–Ω–æ–≤", 
        "üíæ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö"
    ])

    # --- 1. –ü–û–®–ê–ì–û–í–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø (Pretrain + SFT) ---
    with doc_tab1:
        st.markdown("""
        ### –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ—é –º–æ–¥–µ–ª—å: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª

        –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–π LLM —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –≥–ª–∞–≤–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤: **Pretraining** (–û–±—É—á–µ–Ω–∏–µ —Å –Ω—É–ª—è) –∏ **SFT** (–î–æ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö).
        
        ---

        #### üü¢ –®–∞–≥ 1: Pretraining (–û–±—É—á–µ–Ω–∏–µ —Å –Ω—É–ª—è)
        –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –º–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –ø–æ–Ω–∏–º–∞—Ç—å —è–∑—ã–∫, –≥—Ä–∞–º–º–∞—Ç–∏–∫—É –∏ —Ñ–∞–∫—Ç—ã –æ –º–∏—Ä–µ, —á–∏—Ç–∞—è –≥–∏–≥–∞–±–∞–π—Ç—ã —Ç–µ–∫—Å—Ç–∞.

        **1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**
        *   –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **üíæ –î–∞–Ω–Ω—ã–µ**.
        *   –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —É–∂–µ –≤—ã–±—Ä–∞–Ω `HuggingFaceFW/fineweb-2` —Å —Ä—É—Å—Å–∫–∏–º —Å–∞–±—Å–µ—Ç–æ–º `rus_Cyrl`.
        *   –ù–∞–∂–º–∏—Ç–µ **üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**.
        *   **–í–∞–∂–Ω–æ:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–∏–º–∏—Ç—ã, —á—Ç–æ–±—ã –Ω–µ –∫–∞—á–∞—Ç—å –≤–µ—Å—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç!
            *   –í –±–ª–æ–∫–µ **üõ†Ô∏è –§–∏–ª—å—Ç—Ä—ã –∏ –õ–∏–º–∏—Ç—ã** –≤—ã–±–µ—Ä–∏—Ç–µ **"–¢–∏–ø –ª–∏–º–∏—Ç–∞: –°—Ç—Ä–æ–∫–∏"**.
            *   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `100,000` —Å—Ç—Ä–æ–∫ –¥–ª—è –ø–µ—Ä–≤–æ–π –ø—Ä–æ–±—ã (—ç—Ç–æ ~100–ú–ë —Ç–µ–∫—Å—Ç–∞).
            *   –ò–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ **"–ì–ë (–†–∞–∑–º–µ—Ä)"** –∏ —É–∫–∞–∂–∏—Ç–µ `1.0` –ì–ë.
        *   –ù–∞–∂–º–∏—Ç–µ **üöÄ –°–∫–∞—á–∞—Ç—å –∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å**. –§–∞–π–ª `dataset.jsonl` –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ —Å–ø—Ä–∞–≤–∞.

        **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏**
        *   –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **üöÄ –ó–∞–ø—É—Å–∫**.
        *   –í —Å–∞–π–¥–±–∞—Ä–µ (—Å–ª–µ–≤–∞) –Ω–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –†–µ–∂–∏–º**.
        *   **–≠—Ç–∞–ø –æ–±—É—á–µ–Ω–∏—è:** –í—ã–±–µ—Ä–∏—Ç–µ `Pretraining`.
        *   **–ù–∞–∑–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞:** –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –∏–º—è, –Ω–∞–ø—Ä–∏–º–µ—Ä `my_first_model`.
        *   **–ü—Ä–µ—Å–µ—Ç:** –í—ã–±–µ—Ä–∏—Ç–µ `Tiny (25M)` –∏–ª–∏ `Small (80M)`. –î–ª—è –¥–æ–º–∞—à–Ω–µ–≥–æ –ü–ö —ç—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ.

        **3. –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è**
        *   –í —Ä–∞–∑–¥–µ–ª–µ **‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è**:
            *   **Batch Size:** 4 –∏–ª–∏ 8.
            *   **Max Steps:** 1000 (–¥–ª—è —Ç–µ—Å—Ç–∞) –∏–ª–∏ 10,000 (–¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞).
        *   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ø–æ–ª–µ **üìÅ –î–∞—Ç–∞—Å–µ—Ç** –≤—ã–±—Ä–∞–Ω –≤–∞—à `dataset.jsonl`.
        *   –ù–∞–∂–º–∏—Ç–µ –±–æ–ª—å—à—É—é –∫–Ω–æ–ø–∫—É **‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É**.
        *   –°–ª–µ–¥–∏—Ç–µ –∑–∞ –≥—Ä–∞—Ñ–∏–∫–æ–º **Loss** –Ω–∞ –≤–∫–ª–∞–¥–∫–µ **üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**. –û–Ω –¥–æ–ª–∂–µ–Ω –ø–∞–¥–∞—Ç—å üìâ.

        ---

        #### üîµ –®–∞–≥ 2: SFT (Supervised Fine-Tuning)
        –¢–µ–ø–µ—Ä—å –ø—Ä–µ–≤—Ä–∞—Ç–∏–º "—á–∏—Ç–∞—Ç–µ–ª—è" –≤ "—Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞". –ú—ã –Ω–∞—É—á–∏–º –º–æ–¥–µ–ª—å –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã.

        **1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è SFT**
        *   –°–Ω–æ–≤–∞ –≤–∫–ª–∞–¥–∫–∞ **üíæ –î–∞–Ω–Ω—ã–µ**.
        *   –í **"–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã"** –≤—ã–±–µ—Ä–∏—Ç–µ SFT –¥–∞—Ç–∞—Å–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `d0rj/OpenOrca-ru`).
        *   –°–∫–∞—á–∞–π—Ç–µ –µ–≥–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –≤ –®–∞–≥–µ 1. –ù–∞–∑–æ–≤–∏—Ç–µ —Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä, `sft_data.jsonl`.

        **2. –í—ã–±–æ—Ä –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏**
        *   –í–∫–ª–∞–¥–∫–∞ **üöÄ –ó–∞–ø—É—Å–∫**.
        *   **–≠—Ç–∞–ø –æ–±—É—á–µ–Ω–∏—è:** –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ `SFT (Fine-Tuning)`.
        *   –ü–æ—è–≤–∏—Ç—Å—è –ø–æ–ª–µ **üì¶ –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å**. –í—ã–±–µ—Ä–∏—Ç–µ —Ç—É –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä—É—é –≤—ã –æ–±—É—á–∏–ª–∏ –Ω–∞ –®–∞–≥–µ 1 (–Ω–∞–ø—Ä–∏–º–µ—Ä, `home_pretrain/final_model`).
        *   ‚ú® **–ú–∞–≥–∏—è:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (—Å–ª–æ–∏, —Ä–∞–∑–º–µ—Ä—ã) –ø–æ–¥—Ç—è–Ω—É—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! –í–∞–º –Ω–µ –Ω—É–∂–Ω–æ –∏—Ö –º–µ–Ω—è—Ç—å.

        **3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ (Chat Template)**
        *   –í —Ü–µ–Ω—Ç—Ä–µ —ç–∫—Ä–∞–Ω–∞ –ø–æ—è–≤–∏—Ç—Å—è –±–ª–æ–∫ **üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è SFT**.
        *   –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö (Chat –∏–ª–∏ Instruct).
        *   –ù–∞–∑–Ω–∞—á—å—Ç–µ –ø–æ–ª—è –¥–ª—è System, User, Assistant.
        *   –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ **üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä**, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∏–∞–ª–æ–≥ –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

        **4. –ó–∞–ø—É—Å–∫ SFT**
        *   –ù–∞–∂–º–∏—Ç–µ **‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É**.
        *   SFT –æ–±—ã—á–Ω–æ —Ç—Ä–µ–±—É–µ—Ç –º–µ–Ω—å—à–µ —à–∞–≥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 500‚Äì1000).

        ---

        #### üí¨ –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞
        *   –ö–æ–≥–¥–∞ SFT –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è, –∏–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **üí¨ –ß–∞—Ç**.
        *   –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É –Ω–æ–≤—É—é SFT-–º–æ–¥–µ–ª—å.
        *   –ù–∞–ø–∏—à–∏—Ç–µ "–ü—Ä–∏–≤–µ—Ç!".
        """)

    # --- 2. SCALING LAWS ---
    with doc_tab2:
        st.markdown("""
        ## üìà Scaling Laws ‚Äî –ó–∞–∫–æ–Ω—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
        
        **Scaling Laws** ‚Äî —ç—Ç–æ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–µ –∫–∞–∫ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç:
        - **N** ‚Äî —á–∏—Å–ª–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏
        - **D** ‚Äî –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–∫–µ–Ω–æ–≤)
        - **C** ‚Äî –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (FLOPs)
        
        > üí° **–ì–ª–∞–≤–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ:** –ö–∞—á–µ—Å—Ç–≤–æ —É–ª—É—á—à–∞–µ—Ç—Å—è –ø–æ **—Å—Ç–µ–ø–µ–Ω–Ω–æ–º—É –∑–∞–∫–æ–Ω—É** (power law).  
        > –ö–∞–∂–¥–æ–µ —É–¥–≤–æ–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–∞—ë—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π, –Ω–æ —É–º–µ–Ω—å—à–∞—é—â–∏–π—Å—è –≤—ã–∏–≥—Ä—ã—à.
        
        ### ü§î –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?
        
        Scaling Laws –ø–æ–∑–≤–æ–ª—è—é—Ç **–ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å** —Ä–µ–∑—É–ª—å—Ç–∞—Ç –î–û —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã –ø–æ—Ç—Ä–∞—Ç–∏—Ç–µ —Ä–µ—Å—É—Ä—Å—ã:
        
        1. **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –°–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö —Å–æ–±—Ä–∞—Ç—å? –ö–∞–∫–æ–π —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏ –≤—ã–±—Ä–∞—Ç—å?
        2. **–ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –°–∫–æ–ª—å–∫–æ GPU-—á–∞—Å–æ–≤ –Ω—É–∂–Ω–æ –¥–ª—è –∂–µ–ª–∞–µ–º–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞?
        3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ö–∞–∫ –ª—É—á—à–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å compute –º–µ–∂–¥—É —Ä–∞–∑–º–µ—Ä–æ–º –º–æ–¥–µ–ª–∏ –∏ –æ–±—ä—ë–º–æ–º –¥–∞–Ω–Ω—ã—Ö?
        
        ---
        
        ### üìê –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–æ—Ä–º—É–ª—ã
        
        #### 1. –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (Chinchilla, 2022)
        
        –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π loss –º–æ–∂–Ω–æ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª–æ–π:
        
        $$L(N, D) = E + \\frac{A}{N^\\alpha} + \\frac{B}{D^\\beta}$$
        
        –≥–¥–µ:
        - $E$ ‚âà 1.69 ‚Äî —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∏–Ω–∏–º—É–º (—ç–Ω—Ç—Ä–æ–ø–∏—è —è–∑—ã–∫–∞)
        - $A, B$ ‚Äî –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –º–∞—Å—à—Ç–∞–±–∞
        - $\\alpha$ ‚âà 0.34, $\\beta$ ‚âà 0.28 ‚Äî –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å—Ç–µ–ø–µ–Ω–∏
        
        #### 2. –í—ã—á–∏—Å–ª–µ–Ω–∏—è (FLOPs)
        
        –î–ª—è Transformer –º–æ–¥–µ–ª–∏:
        
        $$C ‚âà 6 \\cdot N \\cdot D$$
        
        –≥–¥–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç 6 —É—á–∏—Ç—ã–≤–∞–µ—Ç forward + backward pass.
        
        #### 3. Compute-Optimal —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ (–ø—Ä–∞–≤–∏–ª–æ "20 —Ç–æ–∫–µ–Ω–æ–≤")
        
        **–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç?**
        
        –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±—é–¥–∂–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–π $C$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1000 GPU-—á–∞—Å–æ–≤).
        –í—ã –º–æ–∂–µ—Ç–µ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –∏—Ö –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:
        - üß† **–ë–æ–ª—å—à–∞—è –º–æ–¥–µ–ª—å** (–º–Ω–æ–≥–æ N) + –º–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö (–º–∞–ª–æ D)
        - üìö **–ú–∞–ª–µ–Ω—å–∫–∞—è –º–æ–¥–µ–ª—å** (–º–∞–ª–æ N) + –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö (–º–Ω–æ–≥–æ D)
        
        Chinchilla –ø–æ–∫–∞–∑–∞–ª: **–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ —Ç—Ä–∞—Ç–∏—Ç—å compute –ø–æ—Ä–æ–≤–Ω—É**! –ü—Ä–∏ —É–¥–≤–æ–µ–Ω–∏–∏ –±—é–¥–∂–µ—Ç–∞:
        - –£–≤–µ–ª–∏—á–∏–≤–∞–π –º–æ–¥–µ–ª—å –≤ ~‚àö2 —Ä–∞–∑–∞
        - –£–≤–µ–ª–∏—á–∏–≤–∞–π –¥–∞–Ω–Ω—ã–µ –≤ ~‚àö2 —Ä–∞–∑–∞
        
        –≠—Ç–æ –¥–∞—ë—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∞–≤–∏–ª–æ:
        
        $$D_{opt} ‚âà 20 \\cdot N$$
        
        | –ú–æ–¥–µ–ª—å | Chinchilla-optimal —Ç–æ–∫–µ–Ω—ã |
        |--------|---------------------------|
        | 100M –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ | 2B —Ç–æ–∫–µ–Ω–æ–≤ |
        | 1B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ | 20B —Ç–æ–∫–µ–Ω–æ–≤ |
        | 7B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ | 140B —Ç–æ–∫–µ–Ω–æ–≤ |
        
        > ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –≠—Ç–æ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è *–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ* compute –ø—Ä–∏ –¥–∞–Ω–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ.
        > –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —á–∞—Å—Ç–æ –¥–µ–ª–∞—é—Ç **over-training** (50-200 —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä), 
        > —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –º–µ–Ω—å—à—É—é –º–æ–¥–µ–ª—å —Å —Ç–µ–º –∂–µ –∫–∞—á–µ—Å—Ç–≤–æ–º ‚Äî —ç—Ç–æ –¥–µ—à–µ–≤–ª–µ –≤ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ!
        
        ---
        """)
        
        # --- –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ô –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† ---
        st.markdown("### üßÆ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä Scaling Laws")
        
        calc_mode = st.radio(
            "–ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å?",
            ["üìä –°–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö –Ω—É–∂–Ω–æ –¥–ª—è –º–æ–¥–µ–ª–∏?", 
             "üéØ –ö–∞–∫—É—é –º–æ–¥–µ–ª—å –º–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å –Ω–∞ –º–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö?",
             "‚ö° –°–∫–æ–ª—å–∫–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è?"],
            horizontal=True
        )
        
        st.markdown("---")
        
        if calc_mode == "üìä –°–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö –Ω—É–∂–Ω–æ –¥–ª—è –º–æ–¥–µ–ª–∏?":
            col1, col2 = st.columns(2)
            
            with col1:
                model_size = st.select_slider(
                    "üß† –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏ (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)",
                    options=[25_000_000, 50_000_000, 100_000_000, 200_000_000, 
                            300_000_000, 500_000_000, 800_000_000, 1_000_000_000,
                            3_000_000_000, 7_000_000_000],
                    value=100_000_000,
                    format_func=lambda x: f"{x/1e6:.0f}M" if x < 1e9 else f"{x/1e9:.1f}B"
                )
                
                tokens_per_param = st.slider(
                    "üìö –¢–æ–∫–µ–Ω–æ–≤ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä",
                    min_value=5,
                    max_value=100,
                    value=20,
                    help="Chinchilla-optimal ‚âà 20. –î–ª—è over-training (–¥–µ—à—ë–≤—ã–π –∏–Ω—Ñ–µ—Ä–µ–Ω—Å) –º–æ–∂–Ω–æ 50-100."
                )
            
            with col2:
                optimal_tokens = model_size * tokens_per_param
                compute_flops = 6 * model_size * optimal_tokens
                
                # Peak FP16/BF16 Tensor Core TFLOPS (–±–µ–∑ sparsity)
                gpu_options = {
                    "üéÆ RTX 3090 (71 TFLOPS)": 71e12,
                    "üéÆ RTX 4090 (165 TFLOPS)": 165e12,
                    "üéÆ RTX 5090 (210 TFLOPS)": 210e12,
                    "üñ•Ô∏è A100 80GB (312 TFLOPS)": 312e12,
                    "üñ•Ô∏è H100 SXM (990 TFLOPS)": 990e12,
                    "üñ•Ô∏è H100 PCIe (757 TFLOPS)": 757e12,
                    "üñ•Ô∏è H200 SXM (990 TFLOPS)": 990e12,
                    "üñ•Ô∏è H200 NVL (836 TFLOPS)": 836e12,
                }
                
                st.metric("üìä –ù—É–∂–Ω–æ —Ç–æ–∫–µ–Ω–æ–≤", f"{optimal_tokens/1e9:.2f}B")
                st.metric("‚ö° –í—ã—á–∏—Å–ª–µ–Ω–∏–π (FLOPs)", f"{compute_flops:.2e}")
                
                # –ì—Ä—É–±–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (1 —Ç–æ–∫–µ–Ω ‚âà 4 —Å–∏–º–≤–æ–ª–∞ ‚âà 4 –±–∞–π—Ç–∞)
                data_size_gb = (optimal_tokens * 4) / 1e9
                st.metric("üíæ ~–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö", f"{data_size_gb:.1f} GB —Ç–µ–∫—Å—Ç–∞")
            
            # –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
            st.markdown("#### ‚è±Ô∏è –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è")
            
            selected_gpu = st.selectbox("–í—ã–±–µ—Ä–∏—Ç–µ GPU:", list(gpu_options.keys()))
            mfu = st.slider("MFU (Model FLOPS Utilization)", 0.1, 0.6, 0.3, 
                           help="–†–µ–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GPU. –û–±—ã—á–Ω–æ 20-40%.")
            
            gpu_tflops = gpu_options[selected_gpu]
            effective_tflops = gpu_tflops * mfu
            training_seconds = compute_flops / effective_tflops
            training_hours = training_seconds / 3600
            training_days = training_hours / 24
            
            if training_days >= 1:
                st.info(f"‚è±Ô∏è –ü—Ä–∏–º–µ—Ä–Ω–æ **{training_days:.1f} –¥–Ω–µ–π** –Ω–∞ 1√ó {selected_gpu.split('(')[0].strip()}")
            else:
                st.info(f"‚è±Ô∏è –ü—Ä–∏–º–µ—Ä–Ω–æ **{training_hours:.1f} —á–∞—Å–æ–≤** –Ω–∞ 1√ó {selected_gpu.split('(')[0].strip()}")
        
        elif calc_mode == "üéØ –ö–∞–∫—É—é –º–æ–¥–µ–ª—å –º–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å –Ω–∞ –º–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö?":
            col1, col2 = st.columns(2)
            
            with col1:
                data_tokens = st.number_input(
                    "üìö –°–∫–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω–æ–≤ —É –≤–∞—Å –µ—Å—Ç—å?",
                    min_value=1_000_000,
                    max_value=1_000_000_000_000,
                    value=1_000_000_000,
                    step=100_000_000,
                    format="%d"
                )
                st.caption(f"= {data_tokens/1e9:.2f}B —Ç–æ–∫–µ–Ω–æ–≤")
                
                tokens_per_param = st.slider(
                    "üìö –¢–æ–∫–µ–Ω–æ–≤ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä",
                    min_value=5,
                    max_value=100,
                    value=20,
                    key="tpp2"
                )
            
            with col2:
                optimal_params = data_tokens / tokens_per_param
                
                if optimal_params >= 1e9:
                    size_str = f"{optimal_params/1e9:.2f}B"
                else:
                    size_str = f"{optimal_params/1e6:.0f}M"
                
                st.metric("üß† –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏", size_str)
                
                # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∏–∑ –Ω–∞—à–µ–≥–æ —Å–ø–∏—Å–∫–∞
                model_sizes = [
                    (25e6, "Tiny (25M)", "–ò–≥—Ä—É—à–µ—á–Ω—ã–π LM"),
                    (50e6, "Small (50M)", "–ë—ã—Å—Ç—Ä—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã"),
                    (100e6, "Base (100M)", "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π LLM"),
                    (200e6, "Medium (200M)", "–ü–µ—Å–æ—á–Ω–∏—Ü–∞ –¥–ª—è SFT"),
                    (300e6, "Large (300M)", "–î–æ–º–µ–Ω–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç"),
                    (500e6, "XL (500M)", "–ó–∞–º–µ—Ç–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ"),
                    (800e6, "XXL (800M)", "–ú–∞–ª—ã–π –æ–±—â–∏–π LLM"),
                    (1e9, "1B", "–•–æ—Ä–æ—à–∞—è –±–∞–∑–∞ –¥–ª—è —Ç—é–Ω–∏–Ω–≥–∞"),
                ]
                
                recommended = None
                for size, name, desc in model_sizes:
                    if optimal_params >= size:
                        recommended = (name, desc)
                
                if recommended:
                    st.success(f"‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º: **{recommended[0]}** ‚Äî {recommended[1]}")
        
        else:  # –°–∫–æ–ª—å–∫–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
            col1, col2 = st.columns(2)
            
            with col1:
                model_size = st.select_slider(
                    "üß† –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏",
                    options=[25_000_000, 50_000_000, 100_000_000, 200_000_000, 
                            300_000_000, 500_000_000, 800_000_000, 1_000_000_000],
                    value=100_000_000,
                    format_func=lambda x: f"{x/1e6:.0f}M" if x < 1e9 else f"{x/1e9:.1f}B",
                    key="ms2"
                )
                
                data_tokens = st.number_input(
                    "üìö –¢–æ–∫–µ–Ω–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è",
                    min_value=100_000_000,
                    max_value=100_000_000_000,
                    value=2_000_000_000,
                    step=500_000_000,
                    key="dt2"
                )
            
            with col2:
                compute_flops = 6 * model_size * data_tokens
                
                st.metric("‚ö° –í—ã—á–∏—Å–ª–µ–Ω–∏–π (FLOPs)", f"{compute_flops:.2e}")
                st.metric("üìä PetaFLOPs", f"{compute_flops/1e15:.2f}")
                
                # GPU-–¥–Ω–∏ (A100 = 312 TFLOPS, 30% MFU)
                a100_effective = 312e12 * 0.3
                gpu_days = compute_flops / a100_effective / 86400
                st.metric("üñ•Ô∏è A100 GPU-–¥–Ω–µ–π", f"{gpu_days:.1f}")
        
        st.markdown("---")
        
        # --- –¢–ê–ë–õ–ò–¶–ê –ö–ï–ô–°–û–í ---
        st.markdown("""
        ### üìã –¢–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –º–æ–¥–µ–ª–µ–π
        
        | –†–∞–∑–º–µ—Ä N | D optimal (—Ç–æ–∫–µ–Ω—ã) | Compute (FLOPs) | –ö–µ–π—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |
        |:--------:|:-----------------:|:---------------:|:-------------------|
        | **25M**  | 0.5B | 7.5√ó10¬π‚Å∂ | üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞, –±—ã—Å—Ç—Ä—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã |
        | **50M**  | 1.0B | 3.0√ó10¬π‚Å∑ | üî¨ –ò—Ç–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞, –ø—Ä–æ—Å—Ç–æ–π completion |
        | **100M** | 2.0B | 1.2√ó10¬π‚Å∏ | üìä –ü–µ—Ä–≤—ã–π "–Ω–∞—Å—Ç–æ—è—â–∏–π" LLM, –≤–∏–¥–µ–Ω scaling |
        | **200M** | 4.0B | 4.8√ó10¬π‚Å∏ | üéØ –ü–µ—Å–æ—á–Ω–∏—Ü–∞ –¥–ª—è SFT/LoRA —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ |
        | **300M** | 6.0B | 1.1√ó10¬π‚Åπ | üíº –î–æ–º–µ–Ω–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ—Å–ª–µ SFT |
        | **500M** | 10.0B | 3.0√ó10¬π‚Åπ | ‚ú® –ó–∞–º–µ—Ç–Ω–æ –ª—É—á—à–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –º–æ–∂–Ω–æ RLHF |
        | **800M** | 16.0B | 7.7√ó10¬π‚Åπ | ü§ñ –ú–∞–ª—ã–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π LLM |
        | **1B**   | 20.0B | 1.2√ó10¬≤‚Å∞ | üöÄ –•–æ—Ä–æ—à–∞—è –±–∞–∑–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-—Ç—é–Ω–∏–Ω–≥–∞ |
        
        ---
        
        ### üéì –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã
        
        1. **–ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö > –ë–æ–ª—å—à–µ –º–æ–¥–µ–ª—å**  
           –ü—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º compute –≤—ã–≥–æ–¥–Ω–µ–µ –¥–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã—Ö, —á–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
        
        2. **–ü—Ä–∞–≤–∏–ª–æ 20 —Ç–æ–∫–µ–Ω–æ–≤**  
           Chinchilla-optimal: ~20 —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä. –ù–æ –¥–ª—è –¥–µ—à—ë–≤–æ–≥–æ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–∂–Ω–æ over-train –¥–æ 50-100 —Ç–æ–∫–µ–Ω–æ–≤.
        
        3. **–ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö –≤–∞–∂–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞**  
           –•–æ—Ä–æ—à–æ –æ—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç "–æ–±–æ–≥–Ω–∞—Ç—å" —Å—Ç–µ–ø–µ–Ω–Ω–æ–π –∑–∞–∫–æ–Ω.
        
        4. **–ü–µ—Ä–µ–Ω–æ—Å –∑–Ω–∞–Ω–∏–π**  
           SFT —Ç—Ä–µ–±—É–µ—Ç –≤ 100-1000√ó –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö, —á–µ–º pretraining.
        
        ---
        
        ---
        
        ### üñ•Ô∏è –¢–∞–±–ª–∏—Ü–∞ GPU: Peak TFLOPS
        
        | GPU | FP32 | FP16/BF16 Tensor | VRAM |
        |:----|-----:|-----------------:|-----:|
        | **GeForce RTX 3090** | 35.6 | 71 / 142* | 24 GB |
        | **GeForce RTX 4090** | 82.6 | 165 / 330* | 24 GB |
        | **GeForce RTX 5090** | 104.8 | 210 / 419* | 32 GB |
        | **NVIDIA A100 80GB** | 19.5 | 312 / 624* | 80 GB |
        | **NVIDIA H100 SXM** | 67 | 990 / 1979* | 80 GB |
        | **NVIDIA H100 PCIe** | 51 | 757 / 1513* | 80 GB |
        | **NVIDIA H200 SXM** | 67 | 990 / 1979* | 141 GB |
        
        *\\* ‚Äî —Å–æ Structured Sparsity (2:4), –±–µ–∑ sparsity –≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ*
        
        > üí° **MFU (Model FLOPS Utilization)** ‚Äî —Ä–µ–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.  
        > –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è 20-40% –æ—Ç peak, —Ç.–∫. —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ —É—Ö–æ–¥–∏—Ç –Ω–∞ –ø–∞–º—è—Ç—å, –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é –∏ —Ç.–¥.
        
        ---
        
        ### üìö –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
        
        - **Kaplan et al. (2020)** ‚Äî [Scaling Laws for Neural Language Models](https://arxiv.org/abs/2001.08361)
        - **Hoffmann et al. (2022)** ‚Äî [Training Compute-Optimal LLMs (Chinchilla)](https://arxiv.org/abs/2203.15556)
        - **Bahri et al. (2024)** ‚Äî [Explaining Neural Scaling Laws](https://arxiv.org/abs/2102.06701)
        """)

    # --- 3. –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢ ---
    with doc_tab3:
        st.markdown("""
        ### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏?
        
        **1. –ù–µ–π—Ä–æ—Å–µ—Ç—å ‚Äî —ç—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ–≤–∞**
        –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —á–∏—Ç–∞–µ—Ç–µ –∫–Ω–∏–≥—É, –∏ —è –∑–∞–∫—Ä—ã–≤–∞—é –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–ª–æ–≤–æ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏:
        > *"–ú–∞–º–∞ –º—ã–ª–∞... [?]"*
        
        –í—ã, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —É–≥–∞–¥–∞–µ—Ç–µ —Å–ª–æ–≤–æ *"—Ä–∞–º—É"*. –ù–µ–π—Ä–æ—Å–µ—Ç—å (LLM) –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ. –û–Ω–∞ —á–∏—Ç–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏ –ø—ã—Ç–∞–µ—Ç—Å—è —É–≥–∞–¥–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ (—Ç–æ–∫–µ–Ω).
        
        **2. –û–±—É—á–µ–Ω–∏–µ (Training)**
        * –ú—ã –¥–∞–µ–º –º–æ–¥–µ–ª–∏ –∫—É—Å–æ–∫ —Ç–µ–∫—Å—Ç–∞.
        * –û–Ω–∞ –¥–µ–ª–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ.
        * –ï—Å–ª–∏ –æ–Ω–∞ —É–≥–∞–¥–∞–ª–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –º—ã "–Ω–∞–∫–∞–∑—ã–≤–∞–µ–º" –µ—ë (—ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **Loss** –∏–ª–∏ –û—à–∏–±–∫–∞).
        * –ú—ã —á—É—Ç—å-—á—É—Ç—å –ø–æ–¥–∫—Ä—É—á–∏–≤–∞–µ–º –µ—ë "–≥–∞–π–∫–∏" (–≤–µ—Å–∞), —á—Ç–æ–±—ã –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –æ–Ω–∞ —É–≥–∞–¥–∞–ª–∞ –ª—É—á—à–µ.
        * –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è —Ç—ã—Å—è—á–∏ —Ä–∞–∑.

        **3. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è**
        –ö–æ–º–ø—å—é—Ç–µ—Ä—ã –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç —Å–ª–æ–≤–∞, –æ–Ω–∏ –ø–æ–Ω–∏–º–∞—é—Ç —á–∏—Å–ª–∞.
        –§—Ä–∞–∑–∞ *"–ü—Ä–∏–≤–µ—Ç –º–∏—Ä"* –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –Ω–∞–±–æ—Ä —á–∏—Å–µ–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä `[1054, 2033]`. –≠—Ç–∏ –∫—É—Å–æ—á–∫–∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è **—Ç–æ–∫–µ–Ω–∞–º–∏**.
        
        ---
        
        ### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Transformer
        
        –ù–∞—à–∞ –º–æ–¥–µ–ª—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ **Transformer** (decoder-only, –∫–∞–∫ GPT):
        
        ```
        Input Tokens ‚Üí Embedding ‚Üí [Transformer Blocks √ó N] ‚Üí Output Logits
        
        –ö–∞–∂–¥—ã–π Transformer Block:
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ   Multi-Head Self-Attention     ‚îÇ  ‚Üê "–ö—Ç–æ –Ω–∞ –∫–æ–≥–æ —Å–º–æ—Ç—Ä–∏—Ç"
        ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
        ‚îÇ   Feed-Forward Network (MLP)    ‚îÇ  ‚Üê "–ß—Ç–æ —Å —ç—Ç–∏–º –¥–µ–ª–∞—Ç—å"
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ```
        
        **–ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
        - `hidden_size` ‚Äî —Ä–∞–∑–º–µ—Ä –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (—á–µ–º –±–æ–ª—å—à–µ, —Ç–µ–º "—É–º–Ω–µ–µ")
        - `num_layers` ‚Äî –≥–ª—É–±–∏–Ω–∞ –º–æ–¥–µ–ª–∏ (–±–æ–ª—å—à–µ —Å–ª–æ—ë–≤ = —Å–ª–æ–∂–Ω–µ–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
        - `num_heads` ‚Äî —Å–∫–æ–ª—å–∫–æ "–≥–ª–∞–∑" —Å–º–æ—Ç—Ä—è—Ç –Ω–∞ —Ç–µ–∫—Å—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
        - `vocab_size` ‚Äî —Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è —Ç–æ–∫–µ–Ω–æ–≤
        """)

    # --- 4. –°–õ–û–í–ê–†–¨ ---
    with doc_tab4:
        st.markdown("""
        ### üìñ –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
        
        –≠—Ç–∏ —Å—Ç—Ä–∞—à–Ω—ã–µ —Å–ª–æ–≤–∞ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ—Å—Ç—ã–µ:

        | –¢–µ—Ä–º–∏–Ω | –ü—Ä–æ—Å—Ç–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ |
        |---|---|
        | **Loss (–õ–æ—Å—Å)** | "–û—Ü–µ–Ω–∫–∞ –¥–≤–æ–π–∫–∞". –ß–µ–º –ù–ò–ñ–ï —ç—Ç–æ —á–∏—Å–ª–æ, —Ç–µ–º —É–º–Ω–µ–µ –º–æ–¥–µ–ª—å. –í –Ω–∞—á–∞–ª–µ ~10.0, –≤ –∫–æ–Ω—Ü–µ ~2.0-3.0. |
        | **Perplexity (PPL)** | "–£–¥–∏–≤–ª–µ–Ω–∏–µ" –º–æ–¥–µ–ª–∏. `PPL = e^Loss`. –ï—Å–ª–∏ PPL=100, –º–æ–¥–µ–ª—å "–≤—ã–±–∏—Ä–∞–µ—Ç –∏–∑ 100 —Å–ª–æ–≤". |
        | **Batch Size** | –°–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–∞ —Ä–∞–∑. –ë–æ–ª—å—à–µ = –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ VRAM. |
        | **Gradient Accumulation** | "–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –±–∞—Ç—á". –ù–∞–∫–∞–ø–ª–∏–≤–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –∑–∞ N —à–∞–≥–æ–≤, –ø–æ—Ç–æ–º –æ–±–Ω–æ–≤–ª—è–µ–º. |
        | **Epoch** | –û–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É. |
        | **Learning Rate (LR)** | –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è. –û–±—ã—á–Ω–æ 3e-4 (0.0003) ‚Äî —Ö–æ—Ä–æ—à–∏–π —Å—Ç–∞—Ä—Ç. |
        | **Warmup** | –ü–ª–∞–≤–Ω—ã–π —Ä–∞–∑–≥–æ–Ω LR –≤ –Ω–∞—á–∞–ª–µ –æ–±—É—á–µ–Ω–∏—è. |
        | **VRAM** | –í–∏–¥–µ–æ–ø–∞–º—è—Ç—å GPU. –°–∞–º—ã–π —Ü–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å! |
        | **Checkpoint** | "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã". –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏. |
        | **Overfitting** | –ú–æ–¥–µ–ª—å "–≤—ã–∑—É–±—Ä–∏–ª–∞" —Ç–µ–∫—Å—Ç –Ω–∞–∏–∑—É—Å—Ç—å –∏ –Ω–µ –æ–±–æ–±—â–∞–µ—Ç. |
        | **FLOPs** | Floating Point Operations ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π. |
        | **MFU** | Model FLOPS Utilization ‚Äî –∫–∞–∫–æ–π % –º–æ—â–Ω–æ—Å—Ç–∏ GPU —Ä–µ–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. |
        
        ---
        
        ### üéõÔ∏è –ß—Ç–æ –∫—Ä—É—Ç–∏—Ç—å?
        
        | –ï—Å–ª–∏... | –ü–æ–ø—Ä–æ–±—É–π—Ç–µ |
        |---------|-----------|
        | Loss –Ω–µ –ø–∞–¥–∞–µ—Ç | ‚Üë Learning Rate –∏–ª–∏ ‚Üì Batch Size |
        | Out of Memory | ‚Üì Batch Size, ‚úÖ Gradient Checkpointing |
        | –û–±—É—á–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ | ‚Üë Batch Size, ‚Üì Max Steps |
        | –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º—É—Å–æ—Ä | ‚Üë –î–∞–Ω–Ω—ã—Ö, ‚Üë Max Steps, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ |
        """)

    # --- 5. –î–ê–ù–ù–´–ï ---
    with doc_tab5:
        st.markdown("""
        ### –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã?

        –ú–æ–¥–µ–ª–∏ –æ–±—É—á–∞—é—Ç—Å—è –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–∞—Ö. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ä–º–∞—Ç **JSONL**.
        –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª, –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ—á–∫–∞ ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π JSON –æ–±—ä–µ–∫—Ç.
        
        ---
        
        #### üü¢ –î–ª—è Pretraining
        
        –ù—É–∂–µ–Ω –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ `text`:
        
        ```json
        {"text": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ü—É—à–∫–∏–Ω ‚Äî –≤–µ–ª–∏–∫–∏–π —Ä—É—Å—Å–∫–∏–π –ø–æ—ç—Ç."}
        {"text": "–°—Ç–æ–ª–∏—Ü–∞ –§—Ä–∞–Ω—Ü–∏–∏ ‚Äî –ü–∞—Ä–∏–∂."}
        {"text": "–†–µ—Ü–µ–ø—Ç –±–ª–∏–Ω–æ–≤: –º—É–∫–∞, –º–æ–ª–æ–∫–æ, —è–π—Ü–∞..."}
        ```
        
        ---
        
        #### üîµ –î–ª—è SFT (–¥–≤–∞ —Ñ–æ—Ä–º–∞—Ç–∞)
        
        **–§–æ—Ä–º–∞—Ç Instruct (–ø—Ä–æ—Å—Ç–æ–π):**
        ```json
        {"instruction": "–ü–µ—Ä–µ–≤–µ–¥–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π", "input": "–ü—Ä–∏–≤–µ—Ç", "output": "Hello"}
        {"instruction": "–ß—Ç–æ —Ç–∞–∫–æ–µ Python?", "output": "Python ‚Äî —ç—Ç–æ —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è."}
        ```
        
        **–§–æ—Ä–º–∞—Ç Chat (–¥–∏–∞–ª–æ–≥–∏):**
        ```json
        {"messages": [
          {"role": "system", "content": "–¢—ã –ø–æ–ª–µ–∑–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç."},
          {"role": "user", "content": "–ü—Ä–∏–≤–µ—Ç!"},
          {"role": "assistant", "content": "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"}
        ]}
        ```
        
        ---

        ### üì• –ì–¥–µ –≤–∑—è—Ç—å –¥–∞–Ω–Ω—ã–µ?
        
        | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
        |----------|----------|
        | **FineWeb-2** | –û–≥—Ä–æ–º–Ω—ã–π –≤–µ–±-–∫–æ—Ä–ø—É—Å, –µ—Å—Ç—å —Ä—É—Å—Å–∫–∏–π (`rus_Cyrl`) |
        | **OpenOrca-ru** | –ü–µ—Ä–µ–≤–æ–¥—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –Ω–∞ —Ä—É—Å—Å–∫–∏–π |
        | **ru-instruct** | –°–±–æ—Ä–Ω—ã–π —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç |
        | **–°–≤–æ–∏ —Ñ–∞–π–ª—ã** | –ó–∞–≥—Ä—É–∑–∏—Ç–µ `.txt` ‚Äî –º—ã –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º |
        
        ---
        
        ### üí° –°–æ–≤–µ—Ç—ã –ø–æ –¥–∞–Ω–Ω—ã–º
        
        1. **–ö–∞—á–µ—Å—Ç–≤–æ > –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ**  
           100K —Ö–æ—Ä–æ—à–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –ª—É—á—à–µ 1M –º—É—Å–æ—Ä–∞.
        
        2. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–∞–Ω–Ω—ã–µ**  
           –û—Ç–∫—Ä–æ–π—Ç–µ JSONL –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ, –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —á—Ç–æ –≤–Ω—É—Ç—Ä–∏.
        
        3. **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ**  
           –ú–∏–∫—Å –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞—ë—Ç –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤—É—é –º–æ–¥–µ–ª—å.
        
        4. **Scaling Law**  
           –î–ª—è –º–æ–¥–µ–ª–∏ –Ω–∞ N –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω—É–∂–Ω–æ ~20N —Ç–æ–∫–µ–Ω–æ–≤.
        """)
